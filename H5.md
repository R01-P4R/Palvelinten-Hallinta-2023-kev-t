# x)

 
 
 
 
## 	 Control Windows with Salt, Tero Karvinen (18.4.2018)  (https://terokarvinen.com/2018/control-windows-with-salt/)

Tero Karvinen kertoo artikkelissaan 'Control Windows with Salt', kuinka Saltin avulla voidaan kontrolloida eri prosesseja Windowsilla.

   * Uusimmat Salt-versiot toimivat paremmin Windowsilla, kuin aikaisemmin.
   * Luodakseen Windowsista Salt-orjan on asennettava samat Salt-paketit kyseiselle koneelle, kuin herra-koneella.
   * Windows-koneet on hyväksyttävä uusiksi orjakoneiksi ja ne yleensä vastaavat hitaammin herra-koneen kutsuihin.
   * Saltin Windowsin ohjelmistokirjastot on hyväksyttävä, jotta ohjelmia on helpompi asentaa.
   * PowerShell on Windowsin versio Bash:sta.
   * Saltia voi myös suorittaa Windowsilta käsin paikallisesti.
   * Chocolateyn avulla voi asentaa monia eri paketteja.
   


## Harjoitus 5, Linux-master meets Windows-slave, pseppanen (26.11.2018) (https://pseppanen296518693.wordpress.com/2018/11/26/harjoitus-5-linux-master-meets-windows-slave/)

Pseppasen raportti 'Harjoitus 5, Linux-master meets Windows-slave' käsittelee Saltin käyttöä siten, että Windows on orja-roolissa.

   * Herra- ja orja-koneella on oltava samat Salt-versiot ja paketit käytössä.
   * PowerShellin avulla voi tehdä säädöksiä paikallisesti, ilman herra-orja-arkkitehtuuria
   * Orjaa luodessa on tiedettävä herra-koneen IP-osoite.
   
  
   
   
   
   
 # H5
 
Harjoituksen tarkoituksena on asentaa Windowsille Salt-minionohjelmisto ja 
 

 
 
### Laitteisto
 
* Käyttöjärjestelmä	Microsoft Windows 10 Enterprise LTSC 64 bit
* Prosessori i5-6600
* RAM 16 GB





## Saltin asennus Windowsille (16:14)
Asennetaan Salt v3006.0 Windowsille (https://repo.saltproject.io/salt/py3/windows/latest/Salt-Minion-3006.0-Py3-AMD64-Setup.exe)

Aloitin lataamalla asennustiedoston osoitteesta (https://docs.saltproject.io/salt/install-guide/en/latest/topics/install-by-operating-system/windows.html#windows-downloads)

![image](https://user-images.githubusercontent.com/106889187/235456808-62dea31a-582c-498e-b09c-29c2b514d7fb.png)

  
## Komennettavat koneet (0:00)

Kirjaudutaan komentokoneelle ja hyväksytään, sekä testataan komennettavien koneiden yhteys.

Aloitin kirjautumalla komentokoneelle komennolla:

    > vagrant ssh tmaster
    
Seuraavaksi hyväksyin orja-koneiden lähettämät avaimet komenolla:

    $ sudo salt-key -A
    
![image](https://user-images.githubusercontent.com/106889187/229379341-8728431f-a68e-40a5-a206-aba80b326580.png)
    
 Lopuksi testasin yhteyden komennolla:
 
    $ sudo salt '*' test.ping

![image](https://user-images.githubusercontent.com/106889187/229379388-1fb8dd06-0a2b-4eed-bddf-f191113824ee.png)

Yhteys toimi.

## Package, file, service, user, cmd.run

Kokeillaan eri tiloja idempotenssi-komentoja käyttäen.

Aloitin asentamalla Apache-palvelimen ohjattaville koneille komennolla:

    $ sudo salt '*' state.single pkg.installed apache2
    
 ![image](https://user-images.githubusercontent.com/106889187/229379792-9cd9686b-b38e-4592-a6c1-1dd5473ae204.png)

    
 ![image](https://user-images.githubusercontent.com/106889187/229379771-8469603a-bf41-4052-94cd-dc6a4172fa0f.png)
 
 
 Seuraavaksi tarkistin, että apache-demoni oli päällä komennolla:
 
    $ sudo salt '*' state.single service.running apache2

![image](https://user-images.githubusercontent.com/106889187/229379853-ccbd3a1c-456a-4049-b66d-0774319901db.png)


Seuraavaksi kokeilin, että onnistuuko uuden käyttäjän luominen komennolla:

    $ sudo salt '*' state.single user.present terote01

![image](https://user-images.githubusercontent.com/106889187/229379970-f209eee6-db79-420d-a010-8f81dd7e8b5d.png)

Lopuksi testasin luoda väliaikaisen tiedoston cmd.run-tilalla komennolla:

    $  sudo salt '*' state.single cmd.run 'touch /tmp/tero' creates="/tmp/tero"
    
![image](https://user-images.githubusercontent.com/106889187/229380094-2c16ea69-ddc4-49ba-a30a-ebe609b76cee.png)
   

## Infraa koodina (0:33)

Luodaan 'Hello World' 

Aloitin luomalla hakemiston ja sen sisään tiedoston komennoilla:

    $ sudo mkdir -p /srv/salt/hello
    
    $ sudoedit /srv/salt/hello/init.sls
    
Lisäsin tiedoston sisään:

    /tmp/infra-as-code:
      file.managed
 
 Kokeilin onnistuiko tiedoston luominen komennolla:
 
    $ sudo salt '*' state.apply hello
    
    
![image](https://user-images.githubusercontent.com/106889187/229380407-2f2220b8-5ad9-4432-bb33-437ae696b683.png)

Tiedoston luominen onnistui, vaikka huomasin, että olin tehnyt kirjoitusvirheen 'infra' -> 'ifra'.
 
 ## Lopuksi (0:41)
 
 Tässä harjoituksessa asensin Vagrantin avulla virtuaalikoneita ja harjoittelin komentojen antamista usealla eri koneelle käyttäen Salt-ohjelmaa.
 
## Lähteet



Infra as Code course 2023 Kevät, Tero Karvinen (https://terokarvinen.com/2023/palvelinten-hallinta-2023-kevat/)

Create a Web Page Using Github, Tero Karvinen (28.3.2023)  (https://terokarvinen.com/2023/create-a-web-page-using-github/)

Salt Vagrant - automatically provision one master and two slaves, Tero Karvinen (28.3.2023) (https://terokarvinen.com/2023/salt-vagrant/)

Create Virtual Machines with Vagrant, Tuomas Valkamo (5.12.2022) (https://tuomasvalkamo.com/CMS-course/week-6/)



#### Tehnyt Roi Partanen 2.4.2023-3.4.2023

